<div class="container-fluid row" ng-controller="CalculadoraMainCtrl">
    <div class="col-md-6">
        <div accordion data-close-others="oneAtATime">
            <div accordion-group ng-repeat="category in categories"
                 data-is-open="$first"
                 data-is-disabled="meetsShowReq(category)">
                <div accordion-heading ng-class="category.customId === 'ingenieria_en_sitio'? 'alto': ''">
                    {{category.descripcion}}
                    <div toggle-switch
                         class="pull-right"
                         data-on-label="Sí"
                         data-off-label="No"
                         ng-click="toggleSelected(category, isSelected)"
                         data-ng-model="isSelected"
                         ng-if="category.customId === 'ingenieria_en_sitio'"></div>
                </div>


                <ul ng-if="category.customId === 'tipo_de_cliente'" class="itemsList">
                    <li ng-repeat="item in category.conceptos">
                        <label class="concepto">
                            <input ng-if="category.multiple"
                                   type="checkbox"
                                   name="{{category.customId}}-concepto"
                                   checklist-model="category.rValue"
                                   data-checklist-value="item"/>
                            <input ng-if="!category.multiple"
                                   type="radio"
                                   name="{{category.customId}}-concepto"
                                   ng-model="category.rValue"
                                   ng-value="item"/>
                            {{item.customId}}
                        </label>
                    </li>
                </ul>

                <div ng-show="category.customId === 'ingenieria_en_sitio'">
                    <div class="form-group col-md-6">
                        <select ng-options="component as component.descripcion for component in category.componentes"
                                data-ng-model="category.tempSelected"
                                title="Elige una opción"
                                class="form-control input-sm">
                            <option value="">Elige una opción</option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group col-md-3" ng-show="category.tempSelected"
                             ng-repeat="property in category.tempSelected.propiedades">
                            <input type="number"
                                   ng-show="isStringNumber(property.tipo)"
                                   class="form-control input-sm small-input"
                                   placeholder="{{ property.customId }}"
                                   ng-model="property.rValue"/>
                            <select class="form-control input-sm limit-size"
                                    title="{{ property.descripcion }}"
                                    data-ng-model="property.rValue"
                                    ng-show="isStringVolumetria(property.customId)">
                                <option>Small Bussiness hasta 500 usuarios</option>
                                <option>Medium Bussiness hasta 5,000 usuarios</option>
                                <option>Datacenters & Large Enterprise más de 5,000 usuarios</option>
                            </select>
                            <label ng-show="isStringBoolean(property.tipo)">
                                <input type="checkbox"
                                       ng-model="property.rValue">
                                {{ property.customId }}
                            </label>
                        </div>
                    </div>
                </div>

                <div ng-show="category.customId === 'tecnologia'">
                    <div class="form-group col-md-4">
                        <select ng-options="component as component.customId for component in category.componentes"
                                data-ng-model="category.tempSelected"
                                title="Elige una tecnología"
                                class="form-control input-sm">
                            <option value="">Elige una tecnología</option>
                        </select>
                    </div>
                    <div class="col-md-12">
                        <div class="form-group col-md-4" ng-repeat="property in category.tempSelected.propiedades">
                            <input type="number"
                                   ng-show="isStringNumber(property.tipo)"
                                   class="form-control input-sm small-input"
                                   placeholder="{{ property.customId }}"
                                   ng-change="showChildren(category.tempSelected)"
                                   ng-model="property.rValue"/>
                            <select class="form-control input-sm limit-size"
                                    title="{{ property.descripcion }}"
                                    data-ng-model="property.rValue"
                                    ng-show="isStringVolumetria(property.customId)">
                                <option>Small Bussiness hasta 500 usuarios</option>
                                <option>Medium Bussiness hasta 5,000 usuarios</option>
                                <option>Datacenters & Large Enterprise más de 5,000 usuarios</option>
                            </select>
                            <label ng-show="isStringBoolean(property.tipo)">
                                <input type="checkbox"
                                       ng-model="property.rValue">
                                {{ property.customId }}
                            </label>
                        </div>
                    </div>
                    <div class="col-md-12 form-group" ng-show="category.tempSelected.isPartialSelected">
                        <div class="col-sm-5">
                            <label>
                                <input type="radio"
                                       name="applyTo"
                                       value="all"
                                       ng-change="applyToChanged(category.tempSelected)"
                                       ng-model="category.tempSelected.deviceScope"/>Todos
                            </label>
                            <label>
                                <input type="radio"
                                       name="applyTo"
                                       value="single"
                                       ng-change="applyToChanged(category.tempSelected)"
                                       ng-model="category.tempSelected.deviceScope"/>Uno
                            </label>
                            <label>
                                <input type="radio"
                                       name="applyTo"
                                       value="range"
                                       ng-change="applyToChanged(category.tempSelected)"
                                       ng-model="category.tempSelected.deviceScope"/>Varios
                            </label>
                        </div>
                        <div class="col-sm-7">
                            <select ng-show="category.tempSelected.deviceScope === 'single'"
                                    ng-options="idx as category.tempSelected.customId+' '+idx for idx in category.tempSelected.deviceCountArray"
                                    data-ng-model="category.tempSelected.currentScope"
                                    data-ng-change="deviceScopeChanged(category.tempSelected)"
                                    class="form-control input-sm min-width-x"
                                    title="elige uno para modificar sus opciones"></select>
                            <input type="number"
                                   placeholder="#"
                                   class="form-control input-sm"
                                   data-ng-model="category.tempSelected.currentScope"
                                   data-ng-change="deviceScopeChanged(category.tempSelected)"
                                   ng-show="category.tempSelected.deviceScope === 'range'">
                        </div>
                    </div>
                    <div class="col-md-12 form-group" ng-show="category.tempSelected.isFullSelected">
                        <div class="col-md-4 no-padding-right" ng-repeat="concepto in category.tempSelected.conceptos">
                            <label>
                                <input type="checkbox"
                                       checklist-model="category.tempSelected.currentSelection"
                                       data-checklist-value="concepto"
                                       data-checklist-change="updateSelections(category.tempSelected)"
                                       name="{{ category.customId }}-concepto">
                                {{ concepto.customId.replace(category.tempSelected.customId, '').replace('_', '') }}
                            </label>
                        </div>
                        <div class="col-md-12 btn-group">
                            <a href=""
                               class="btn btn-link right-float"
                               title="Pegar"
                               ng-click="pasteSelection(category.tempSelected)"
                               data-ng-disabled="category.tempSelected.deviceScope === 'all' || !category.tempSelected.clipboard">
                                <span class="glyphicon glyphicon-paste"></span>
                            </a>
                            <a href=""
                               class="btn btn-link right-float"
                               title="Copiar"
                               ng-click="copySelection(category.tempSelected)"
                               data-ng-disabled="category.tempSelected.deviceScope === 'all'">
                                <span class="glyphicon glyphicon-copy"></span>
                            </a>
                            <a href=""
                               class="btn btn-link right-float"
                               title="Desmarcar todos"
                               ng-click="selectNone(category.tempSelected)"
                               data-ng-disabled="!category.tempSelected.currentSelection || !(category.tempSelected.currentSelection.length > 0)">
                                <span class="glyphicon glyphicon-unchecked"></span>
                            </a>
                            <a href=""
                               class="btn btn-link right-float"
                               title="Marcar todos"
                               ng-click="selectAll(category.tempSelected)"
                               data-ng-disabled="category.tempSelected.currentSelection && (category.tempSelected.currentSelection.length === category.tempSelected.conceptos.length)">
                                <span class="glyphicon glyphicon-check"></span>
                            </a>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>


    <div class="col-md-6">
        <div class="panel panel-default">
            <div class="panel-body">
                <div>
                    <h3>Resumen general</h3>
                </div>
                <!--{{ categories }}-->
                <div class="col-md-12" ng-repeat="category in categories">
                    Catego     {{ category.customId }} - {{ category.rValue }}
                    <div class="col-md-12" ng-repeat="property in category.propiedades">
                        Prop    {{ property.customId }} - {{ property.rValue }}
                    </div>
                    <div class="col-md-12" ng-repeat="concepto in category.conceptos">
                        Concep    {{ concepto.customId }} - {{ concepto.rValue }}<br/>{{ monitor2(concepto) }}
                    </div>
                    <div class="col-md-12" ng-repeat="componente in category.componente">
                        Compo    {{ componente.customId }} - {{ componente.rValue }}
                        <div class="col-md-12" ng-repeat="property in componente.propiedades">
                            Prop      {{ property.customId }} - {{ property.rValue }}
                        </div>
                        <div class="col-md-12" ng-repeat="concepto in componente.conceptos">
                            Concep      {{ concepto.customId }} - {{ concepto.rValue }}
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-primary" ng-click="calcular()"
                        data-ng-disabled="isReady()">Calcular
                </button>
            </div>
        </div>
    </div>

    <div class="col-md-12">
        <div ng-show="resultados">
            <h4>Número de tickets</h4>
            <p>
                Acontinuación se muestran los resultados de manera desglosada.
            </p>
            <p>
                La primera fila tiene la información 'base' de número de tickets. El registro (en BD) seleccionado
                coincide con todas o el mayor numero de 'dependencias' seleccionadas por el usuario.
            </p>
            <p>
                Las filas restantes mustran el resultado parcial obtenido al aplicar los factores coincidentes, de
                acuerdo a lo seleccionado por el usuario.
            </p>
            <p>
                La última fila es el resultado total.
            </p>
            <table class="table table-striped">
                <thead>
                <th>Nombre</th>
                <th>Descripción</th>
                <th>CC</th>
                <th>ES</th>
                <th>RQ</th>
                <th>AS</th>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
        <div ng-show="noMatches()">
            Ninguna regla coincide para lo seleccionado
        </div>
    </div>

    <div class="col-md-12">
        <div class="col-md-12" ng-repeat="catego in categories">
            <em>{{ catego.customId }}</em>
            <br/>
            <strong> rValue </strong>{{ catego.rValue }}
            <br/>
            <strong> tempSelected </strong>{{ catego.tempSelected }}
            <div class="col-md-12" ng-repeat="prop in catego.propiedades">
                <em>{{ prop.customId }}</em>
                <br/>
                <strong> rValue </strong>{{ prop.rValue }}
            </div>
            <div class="col-md-12" ng-repeat="compo in catego.componentes">
                <em>{{ compo.customId }}</em>
                <br/>
                <strong> rValue </strong>{{ compo.rValue }}
                <div class="col-md-12" ng-repeat="propi in compo.propiedades">
                    <em>{{ propi.customId }}</em>
                    <br/>
                    <strong> rValue </strong>{{ propi.rValue }}
                </div>
            </div>
            <br/>
            <br/>
        </div>
    </div>

</div>